#!/bin/sh
#
# Start the keyscanner
#

case "$1" in
  start)


	echo "Starting keyscanner... "
	MODULE=/lib/modules/STLinux-[%ENV.LINUX_VERSION%]/keyscanner.ko
	test -e $MODULE && insmod $MODULE
	if [ ! -c /dev/keypad ]; then
		mknod /dev/keypad c 99 0
	fi
	if [ -n "`grep "board_name=stb840_ch7162" /proc/cmdline`" ]; then
		MODULE=/lib/modules/STLinux-[%ENV.LINUX_VERSION%]/ct1628.ko
		test -e $MODULE && insmod $MODULE
	fi
	;;
  stop)
	rmmod keyscanner
	;;
  restart|reload)
	"$0" stop
	"$0" start
	;;
  *)
	echo $"Usage: $0 {start|stop|restart}"
	exit 1
esac

exit $?

